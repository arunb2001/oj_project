<!DOCTYPE html>
<html lang="en">
<head>

  <title>Problems Page</title>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="favicon.ico" type="image/x-iconz" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/4.3.0/introjs.min.css" />
  <link rel="stylesheet" href="https://d1lrk9cp1c3gxw.cloudfront.net/static/main/assets/css/base.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atom-one-dark.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap4.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  <script src="https://unpkg.com/highlightjs-badge/highlightjs-badge.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  {% comment %} <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script> {% endcomment %}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap4.min.js"></script>

  <style>
    {% comment %} .code-badge, .code-badge-language, .code-badge-copy-icon, .code-badge-check-icon {
      display: none !important;
    } {% endcomment %}
    {% comment %} .page-content-edited {
      transition: all 0.4s;
      padding-left: 2rem;
      padding-right: 2rem;
    } {% endcomment %}
    .nav-pills .nav-link.active, .nav-pills .show>.nav-link {
      color: white !important;
      background-color: #178139;
    }
    {% comment %} .alert1 {
      position: relative;
      padding: 0.75rem 1.25rem;
      border: 1px solid transparent;
      border-top-color: transparent;
      border-right-color: transparent;
      border-bottom-color: transparent;
      border-left-color: transparent;
      border-radius: 5px;
    } {% endcomment %}
  
    {% comment %} .alert-error {
      color: #852b3a;
      background-color: #ffdde2;
      border-color: #ffcfd7;
    }
  
    .alert-success {
      color: #18705f;
      background-color: #d5f7f0;
      border-color: #c4f4eb;
    } {% endcomment %}
  
    {% comment %} .alert-info {
      color: #00626e;
      background-color: #ccf2f6;
      border-color: #b8ecf3;
    } {% endcomment %}
  
    {% comment %} .alert-warning {
      color: #855f28;
      background-color: #fff0db;
      border-color: blanchedalmond;
    } {% endcomment %}
  
    {% comment %} .closebtn {
      margin-left: 15px;
      color: white;
      font-weight: bold;
      float: right;
      font-size: 22px;
      line-height: 20px;
      cursor: pointer;
      transition: 0.3s;
    } {% endcomment %}
  
    {% comment %} .closebtn:hover {
      color: black;
    } {% endcomment %}
  </style>



</head>

<body>

  {% comment %} <header class="p-3 bg-dark text-white">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
        <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
          <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
        </a>

        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
          <li><a href="/" class="nav-link px-2 text-white">Home</a></li>
          <li><a href="#" class="nav-link px-2 text-white">Hello, {{username}} </a></li>
        </ul>

        <div class="text-end float-right">
          <a href=" {% url 'logout' %} "><button type="button" class="btn btn-outline-light me-2">Logout</button></a>
        </div>
      </div>
    </div>
  </header> {% endcomment %}

  <div class="vertical-nav d-flex flex-column flex-shrink-0 p-3 text-white bg-dark overflow-hidden" id="sidebar" style="width: 280px;">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
      <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"></use></svg>
      <span class="fs-4"></span>
    </a>
    <hr>
    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item">
        <a id="problems-tab" data-toggle="tab" href="#problems" role="tab" aria-controls="problems" aria-selected="true"
            class="nav-link text-white active">Problems</a>
        {% comment %} <a href="#" class="nav-link active" aria-current="page">
          <svg class="bi me-2" width="16" height="16"><use xlink:href="#home"></use></svg>
          Problems
        </a> {% endcomment %}
      </li>
      <li>
        <a id="submissions-tab" data-toggle="tab" href="#submissions" role="tab" aria-controls="submissions" aria-selected="false"
            class="nav-link text-white">Submissions</a>
      </li>
      <li>
        <a id="leaderboard-tab" data-toggle="tab" href="#leaderboard" role="tab" aria-controls="leaderboard" aria-selected="false"
            class="nav-link text-white">Leaderboard</a>
      </li>
    </ul>
    <hr>
    {% comment %} <div class="d-flex flex-column"> {% endcomment %}
    <div class="d-flex justify-content-between">
      <div class="dropdown">
        <a href="#" class="d-flex align-items-center text-white text-decoration-none py-2" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
          {% comment %} <img src="https://github.com/mdo.png" alt="" width="32" height="32" class="rounded-circle me-2"> {% endcomment %}
          <strong>Hello, {{username}}</strong>
        </a>
      </div>
      <div class="text-end float-right">
        <a href=" {% url 'logout' %} "><button type="button" class="btn btn-outline-light me-2">Logout</button></a>
      </div>
    </div>
  </div>

<!-- Page Content -->

<div class="page-content mt-5" id="content">



{% comment %} <script>
  setTimeout(function remove_message() {
    $(".alert1").css("display","none")
  }, 3000);
</script> {% endcomment %}

<div class="container">
  <div class="row justify-content-center">
    <div class="col-sm-12">

      <h3 class="text-center text-uppercase mb-4 opacity-h">Problems Page</h3>

      <!-- <a href="/leaderboard/214" role="button" class="btn btn-danger text-light mb-4">Leaderboard<i class="bx bx-right-arrow-alt bx-middle ml-1"></i></a>
      <a href="/submissions/214" role="button" class="btn btn-secondary text-light mb-4">Submissions<i class="bx bx-right-arrow-alt bx-middle ml-1"></i></a> -->

      <!-- Tabs -->

      {% comment %} <ul id="myTab1" role="tablist" class="nav nav-tabs nav-pills flex-column flex-sm-row text-center">
        <li class="nav-item flex-sm-fill">
          <a id="problems-tab" data-toggle="tab" href="#problems" role="tab" aria-controls="problems" aria-selected="true"
            class="nav-link text-uppercase font-weight-bold mr-sm-3 rounded-0 border active">Problems</a>
        </li>
        <li class="nav-item flex-sm-fill">
          <a id="submissions-tab" data-toggle="tab" href="#submissions" role="tab" aria-controls="submissions" aria-selected="false"
            class="nav-link text-uppercase font-weight-bold mr-sm-3 rounded-0 border">Submissions</a>
        </li>
        <li class="nav-item flex-sm-fill">
          <a id="leaderboard-tab" data-toggle="tab" href="#leaderboard" role="tab" aria-controls="leaderboard" aria-selected="false"
            class="nav-link text-uppercase font-weight-bold mr-sm-3 rounded-0 border">Leaderboard</a>
        </li>
      </ul> {% endcomment %}

      <!-- Tab Content -->

      <div id="myTab1Content" class="tab-content">

        <!-- Problems -->

        <div id="problems" role="tabpanel" aria-labelledby="problems-tab" class="tab-pane fade py-4 show active">
          
          <!-- MCQ -->

          

          <!-- Table -->                 

            <div class="table-responsive">
              <table class="table table-striped table-bordered table-hover shadow">
                <thead class="text-center thead-dark">
                  <tr>
                    <th>Problems</th>
                    <th style="width: 20%;">Status</th>
                    <th style="width: 20%;">Difficulty</th>
                    <th style="width: 20%;">Total Submissions</th>
                    
                  </tr>
                </thead>
                <tbody>
                    {% for problem in problems %}
                      <tr onclick="window.location='/problem/{{problem.id}}'">
                        <td><strong>{{problem.name}}</strong></td>
                        <td class="text-center"></td>
                        <td class="text-center">{{problem.difficulty}}</td>
                        <td class="text-center">10</td>
                    {% endfor %}
                    
                </tbody>
              </table>
            </div>

          

        </div>

        <!-- Submissions -->

        <div id="submissions" role="tabpanel" aria-labelledby="submissions-tab" class="tab-pane fade py-4">


          <!-- Table -->
          <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover shadow">
              <thead class="text-center thead-dark">
                <tr>
                  <th>Timestamp</th>
                  <th>Problem</th>
                  <th>Submitted by</th>
                  <th>Verdict</th>
                  <th>Code</th>
                  
                </tr>
              </thead>
              <tbody>
                  {% for submission in submissions %}
                    <tr onclick="window.location='/problem/{{problem.id}}'">
                      <td><strong>{{submission.timestamp}}</strong></td>
                      <td class="text-center">{{submission.problemID}}</td>
                      <td class="text-center">{{submission.userID}}</td>
                      <td class="text-center">{{submission.verdict}}</td>
                      <td class="text-center">Code</td>
                  {% endfor %}
                  
              </tbody>
            </table>
          </div>
          

        </div>

        <!-- Leaderboard -->

        <div id="leaderboard" role="tabpanel" aria-labelledby="leaderboard-tab" class="tab-pane fade py-4">

          <div class="d-flex justify-content-center" style="display: none;">
            <div class="loader spinner-border text-danger mt-5" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
    
          <div class="table-responsive">
            <table id="data-table" class="table table-striped table-bordered shadow">
            </table>
          </div>

        </div>

      </div>

    </div>
  </div>
</div>

<!-- Script -->

<script>

  {% comment %} window.onload = function() {

    function getQueryVariable(variable) {
      var query = window.location.search.substring(1);
      var vars = query.split("&");
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split("=");
        if (pair[0] == variable) {
          return pair[1];
        }
      }
    }

    var tab = getQueryVariable("tab");
    console.log(tab);
    if (tab === "submissions" || window.location.href.indexOf("search") > -1) {
      document.getElementById("submissions-tab").click();
    } else if (tab === "leaderboard") {
      document.getElementById('leaderboard-tab').click();
    }

  } {% endcomment %}

  {% comment %} $(document).ready(function() {
    fetchData();
  }); {% endcomment %}

  {% comment %} function fetchData() {
    $.ajax({
      url: '/leaderboard/214',
      type: 'GET',
      beforeSend: function() {
        $(".loader").show();
      },
      success: function(response) {

        data = JSON.parse(response.name);
        // console.log(data);
        lboard_details = data["lboard_details"];
        problem_ranks_cnt = lboard_details["problem_ranks"].length;
        mcq_count = data["mcq_count"];
        data = lboard_details["data"];
        item = document.getElementById("data-table");
        var html = [];

        html.push(`
          <thead class="text-center thead-dark th-sm">
            <tr>
              <th rowspan="2">User</th>
        `);

        if (mcq_count > 0)
          html.push(`<th rowspan="2">Problem Score</th>`);

        html.push(`<th rowspan="2">Penalty</th>`);

        if (mcq_count > 0)
          html.push(`<th rowspan="2">MCQ Score</th>`);

        html.push(`<th rowspan="2">Total Score</th>`);

        if (problem_ranks_cnt > 0)
          html.push(`<th colspan="${ problem_ranks_cnt }">Problems</th>`);

        html.push(`</tr><tr>`);

        for (const i in lboard_details["problem_ranks"])
          html.push(`<th>` + (parseInt(i) + parseInt(1)) + `</th>`);

        html.push(`</tr></thead><tbody>`);

        for (const i in data) {

          let entry = data[i];
          console.log(entry);

          if (entry["solved"] == problem_ranks_cnt && problem_ranks_cnt > 0)
            html.push(`<tr class="table-success">`);
          else
            html.push(`<tr>`);

          html.push(`<td>${ entry["user"] }</td>`);

          if (mcq_count > 0)
            html.push(`<td class="text-center">${ entry["solved"] }</td>`);

          html.push(`<td class="text-center">${ entry["penalty"] }</td>`);

          if (mcq_count > 0)
            html.push(`<td class="text-center">${ entry["mcq_score"] }</td>`);

          if (mcq_count > 0)
            html.push(`<td class="text-center">${ entry["final_score"] }</td>`);
          else
            html.push(`<td class="text-center">${ entry["final_score"] } ... (${ entry["solved"] }/${ problem_ranks_cnt })</td>`);

          for (var k in entry["tries"]) {
            value =  entry["tries"][k];
            for (var a in entry["prob_state"]) {
              b = entry["prob_state"][a];
              if (a == k) {
                if (b == 0)
                  html.push(`<td class="text-center text-primary">${ value }</td>`);
                else if (b == 1)
                  html.push(`<td class="text-center text-success">${ value }</td>`);
                else if (b == -1)
                  html.push(`<td class="text-center text-danger">${ value }</td>`);
                else
                  html.push(`<td class="text-center">${ value }</td>`);
              }
            }
          }

          if (entry["last_mcq_array"].length) {
            html.push(`
              <tr>
                <th class="bg-secondary text-light" colspan="5">MCQ Last Attempt</th>
              </tr>
              <tr>
                <td colspan="5">
                  <div style="display:flex; min-width:100% !important;">
            `);
            for (var x in entry["last_mcq_array"]) {
              console.log(entry["last_mcq_array"]);
              a = entry["last_mcq_array"][x];
              num = parseInt(x) + 1;
              console.log(a);
              // console.log(a["choice"]);
              // console.log(a["correct_choice"]);
              if (a["choice"] == a["correct_choice"])
                html.push(`<div style="height:40px; width:40px; border-radius:7px; margin:5px; display:flex; justify-content:center; align-items:center; font-weight: 700; background-color:#57DA74;">` + num + `</div>`);
              else
                html.push(`<div style="height:40px; width:40px; border-radius:7px; margin:5px; display:flex; justify-content:center; align-items:center; font-weight: 700; background-color:#F99E9E;">` + num + `</div>`);
            }
            html.push(`<div></td></tr>`);
          }

          html.push(`</tr>`);

        }

        html.push(`</tbody>`);

        item.innerHTML = html.join("");

        if (mcq_count == 0)
          $('#data-table').DataTable({ 
            destroy: true,
            responsive: true,
            autoWidth: false,
            ordering: false,
          });

      },
      complete: function() {
        $(".loader").hide();
      }
    });
  } {% endcomment %}

</script>



</div>

<!-- Script -->

<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.countdown/2.2.0/jquery.countdown.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/4.3.0/intro.min.js"></script>
<script src="https://d1lrk9cp1c3gxw.cloudfront.net/static/main/assets/js/base.js"></script>
{% comment %} <script src="/docs/5.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script> {% endcomment %}




</body>

</html>